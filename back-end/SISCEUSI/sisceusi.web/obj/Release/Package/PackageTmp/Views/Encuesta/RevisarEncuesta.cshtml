@using Newtonsoft.Json;
@using sisceusi.entidad
@{
    ViewBag.Title = "RevisarEncuesta";
    ControlEncuestaBE controlEncuesta = ViewData["controlEncuesta"] == null ? new ControlEncuestaBE() : (ControlEncuestaBE)ViewData["controlEncuesta"];
    List<ParametroBE> listaMetodoVerificacion = ViewData["listaMetodoVerificacion"] == null ? new List<ParametroBE>() : (List<ParametroBE>)ViewData["listaMetodoVerificacion"];
    List<ParametroBE> listaValidezEntrevista = ViewData["listaValidezEntrevista"] == null ? new List<ParametroBE>() : (List<ParametroBE>)ViewData["listaValidezEntrevista"];
    DateTime fechaActual = DateTime.Now;
    string encCode = "ENC" + controlEncuesta.campanaEmpresa.campana.idCampana.ToString("D4");
}

@section scripts_footer {
    <script src="@Url.Content("~/Scripts/Sisceusi/encuesta_revisar.js")"></script>
}

<div class="container-fluid map-root" id="historia"></div>
<div class="container my-4" id="cuerpo">
    <div class="row">
        <div class="col-12">
            <div class="container m-0 px-0 py-4">
                <div class="row">
                    <div class="col-12 d-flex">
                        <div class="bg-light w-100 p-4">
                            <div class="h4 text-cyan">@encCode CUESTIONARIO - DATOS DE CONTROL III – PROVEEDOR Y VERIFICADOR</div>
                        </div>
                    </div>
                </div>
                <div class="dropdown-divider my-4"></div>
                <div class="row">
                    <div class="col-12">
                        <div class="row">
                            <div class="col-xm-12 col-sm-12 col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label class="font-weight-bold" for="txt-proveedor">DC15. IDENTIFICACIÓN DEL PROVEEDOR</label>
                                    <input class="form-control" type="text" id="txt-proveedor" placeholder="Ingrese identificación del proveedor" value="@controlEncuesta.campanaEmpresa.empresaIndustria.nombreEmpresa" readonly>
                                </div>
                            </div>
                            <div class="col-xm-12 col-sm-12 col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label class="font-weight-bold" for="txt-verificador">DC16. IDENTIFICACIÓN DEL VERIFICADOR</label>
                                    <input class="form-control" type="text" id="txt-verificador" placeholder="Ingrese identificación del verificador" value="@controlEncuesta.revisor.nombres" readonly>
                                </div>
                            </div>
                            <div class="col-xm-12 col-sm-12 col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label class="font-weight-bold" for="cbo-distrito">DC17. MÉTODO DE VERIFICACIÓN</label>
                                    <select class="form-control" id="cbo-metodo-verificacion">
                                        <option value="0">-Seleccione un método-</option>
                                        @*<option value="1">Coincidencial</option>
                                        <option value="2">Telefónica</option>
                                        <option value="3">Re-entrevista presencial</option>*@
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xm-12 col-sm-12 col-md-2 col-lg-2">
                                <div class="form-group">
                                    <label class="font-weight-bold" for="txt-fecha-verificacion">DC18. F. VERIFICAC.</label>
                                    <input class="form-control" type="date" value="@fechaActual.ToString("yyyy-MM-dd")" id="txt-fecha-verificacion" readonly>
                                </div>
                            </div>
                            <div class="col-xm-12 col-sm-12 col-md-2 col-lg-2">
                                <div class="form-group">
                                    <label class="font-weight-bold" for="txt-hora-finalizacion">DC19. HORA DE FIN</label>
                                    <input class="form-control" type="time" value="@fechaActual.ToString("HH:mm")" id="txt-hora-finalizacion" readonly>
                                </div>
                            </div>
                            <div class="col-xm-12 col-sm-12 col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label class="font-weight-bold" for="cbo-validez-entrevista">VALIDEZ DE LA ENTREVISTA</label>
                                    <select class="form-control" id="cbo-validez-entrevista">
                                        <option value="0">-Seleccione una validez-</option>
                                        @*<option value="1">Entrevista válida</option>
                                        <option value="2">Entrevista no válida</option>*@
                                    </select>
                                </div>
                            </div>
                            <div class="col-xm-12 col-sm-12 col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label class="font-weight-bold" for="txt-validez-entrevista">DC20. RESULTADO VALIDEZ ENTREVISTA</label>
                                    <input class="form-control" type="text" id="txt-validez-entrevista" placeholder="Ingrese resultado de validez entrevista">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dropdown-divider my-4"></div>                
                <div class="row">
                    <div class="col-xm-12 col-sm-12 col-md-3 col-lg-3">
                        <button class="btn btn-warning w-100 mb-3 text-white" data-toggle="tooltip" data-placement="top" title="Para iniciar lea detenidamente las secciones de información, y seleccione la opción que considere conveniente, luego haga click en continuar para comenzar el llenado de las respuestas, de ser el caso."><i class="fas fa-question-circle pr-1"></i>Ayuda</button>
                    </div>
                    <div class="col-xm-12 col-sm-12 col-md-3 col-lg-3"><a class="btn btn-plomo w-100 mb-3" href="@Url.Action("Index", "Interno")">Salir</a></div>
                    <div class="col-xm-12 col-sm-12 col-md-3 col-lg-3"><span id="btn-opc-finalizar" data-toggle="modal" data-target="#observar-encuesta"><a class="btn btn-danger w-100 mb-3" href="javascript:void(0)">Observar</a></span></div>
                    <div class="col-xm-12 col-sm-12 col-md-3 col-lg-3"><span id="btn-opc-observar" data-toggle="modal" data-target="#grabar-encuesta"><a class="btn btn-success w-100 mb-3" href="javascript:void(0)">Aprobar</a></span></div>
                </div>
            </div>
        </div>
    </div>
</div>
<input type="hidden" id="identificador" value="@controlEncuesta.idControlEncuesta" />
<input type="hidden" id="fecha-revision" value="@fechaActual" />

<div class="modal fade" id="observar-encuesta" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body medidas-modal">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <div class="swal2-icon swal2-question swal2-icon-show" style="display: flex;">
                            <div class="swal2-icon-content"><i class="fas fa-bell"></i></div>
                        </div>
                        <h3 class="text-center">¡Encuesta con observaciones!</h3>
                        <p class="text-center">Los datos ingresados serán almacenados para subsanarlos y las obervaciones serán entregadas a los usuarios responsables.</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 seccion-mensaje-observado">
                    </div>
                </div>
            </div>
            <div class="modal-footer d-flex justify-content-center">
                <button id="btn-observar" class="btn btn-info" type="button">Si, confirmar</button>
                <button class="btn btn-dark" type="button" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="grabar-encuesta" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body medidas-modal">
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <div class="swal2-icon swal2-question swal2-icon-show" style="display: flex;">
                            <div class="swal2-icon-content"><i class="fas fa-info"></i></div>
                        </div>
                        <h3 class="text-center">Gracias por revisar la encuesta</h3>
                        <p class="text-center">Los datos ingresados serán almacenados, los resultados lo podrá generar desde la bandeja de encuestas.</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 seccion-mensaje-revision">
                    </div>
                </div>
            </div>
            <div class="modal-footer d-flex justify-content-center">
                <button id="btn-grabar" class="btn btn-azul" type="button">Si, grabar</button>
                <button class="btn btn-dark" type="button" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var listaMetodoVerificacion = @Html.Raw(JsonConvert.SerializeObject(listaMetodoVerificacion));
    var listaValidezEntrevista = @Html.Raw(JsonConvert.SerializeObject(listaValidezEntrevista));
</script>

